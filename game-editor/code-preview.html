<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®æ—¶ä»£ç é¢„è§ˆ - Game Editor</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1a1a1a;
            color: #fff;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            height: 100vh;
            overflow: hidden;
        }
        
        .header {
            background: #2a2a2a;
            border-bottom: 1px solid #444;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 18px;
            color: #4ECDC4;
        }
        
        .header-controls {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            background: #4ECDC4;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .btn:hover {
            background: #44A08D;
        }
        
        .content {
            display: flex;
            height: calc(100vh - 60px);
        }
        
        .code-tabs {
            background: #2a2a2a;
            border-right: 1px solid #444;
            width: 200px;
            overflow-y: auto;
        }
        
        .code-tab {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #444;
            transition: background 0.2s ease;
            font-size: 13px;
        }
        
        .code-tab:hover {
            background: #333;
        }
        
        .code-tab.active {
            background: #4ECDC4;
            color: white;
        }
        
        .code-content {
            flex: 1;
            overflow: hidden;
        }
        
        .tab-pane {
            display: none;
            height: 100%;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .code-display {
            background: #1a1a1a;
            color: #e6e6e6;
            padding: 20px;
            height: 100%;
            overflow: auto;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .code-display .keyword {
            color: #ff6b6b;
        }
        
        .code-display .string {
            color: #4ECDC4;
        }
        
        .code-display .number {
            color: #feca57;
        }
        
        .code-display .comment {
            color: #666;
        }
        
        .code-display .function {
            color: #48dbfb;
        }
        
        .code-display .class {
            color: #ff9ff3;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: #666;
        }
        
        .error {
            color: #ff6b6b;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“„ å®æ—¶ä»£ç é¢„è§ˆ</h1>
        <div class="header-controls">
            <button class="btn" onclick="refreshCode()">ğŸ”„ åˆ·æ–°</button>
            <button class="btn" onclick="copyCode()">ğŸ“‹ å¤åˆ¶</button>
            <button class="btn" onclick="downloadCode()">ğŸ’¾ ä¸‹è½½</button>
        </div>
    </div>
    
    <div class="content">
        <div class="code-tabs">
            <div class="code-tab active" data-tab="game-logic">ğŸ® æ¸¸æˆé€»è¾‘</div>
            <div class="code-tab" data-tab="runtime">âš¡ è¿è¡Œæ—¶å¼•æ“</div>
            <div class="code-tab" data-tab="index-html">ğŸ“„ index.html</div>
            <div class="code-tab" data-tab="config">âš™ï¸ é…ç½®æ–‡ä»¶</div>
        </div>
        
        <div class="code-content">
            <!-- æ¸¸æˆé€»è¾‘æ ‡ç­¾é¡µ -->
            <div id="game-logic-tab" class="tab-pane active">
                <div id="gameLogicDisplay" class="code-display">
                    <div class="loading">æ­£åœ¨åŠ è½½æ¸¸æˆé€»è¾‘ä»£ç ...</div>
                </div>
            </div>
            
            <!-- è¿è¡Œæ—¶å¼•æ“æ ‡ç­¾é¡µ -->
            <div id="runtime-tab" class="tab-pane">
                <div id="runtimeDisplay" class="code-display">
                    <div class="loading">æ­£åœ¨åŠ è½½è¿è¡Œæ—¶å¼•æ“ä»£ç ...</div>
                </div>
            </div>
            
            <!-- index.htmlæ ‡ç­¾é¡µ -->
            <div id="index-html-tab" class="tab-pane">
                <div id="indexHtmlDisplay" class="code-display">
                    <div class="loading">æ­£åœ¨åŠ è½½HTMLä»£ç ...</div>
                </div>
            </div>
            
            <!-- é…ç½®æ–‡ä»¶æ ‡ç­¾é¡µ -->
            <div id="config-tab" class="tab-pane">
                <div id="configDisplay" class="code-display">
                    <div class="loading">æ­£åœ¨åŠ è½½é…ç½®æ–‡ä»¶...</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ä»£ç ç”Ÿæˆå™¨æ¨¡æ‹Ÿ
        class CodeGenerator {
            generateGameLogic() {
                return `// æ¸¸æˆé€»è¾‘ä»£ç 
// ç”±èŠ‚ç‚¹ç¼–è¾‘å™¨è‡ªåŠ¨ç”Ÿæˆ

class GameLogic {
    constructor() {
        this.score = 0;
        this.lives = 3;
        this.isRunning = false;
    }
    
    start() {
        this.isRunning = true;
        console.log('æ¸¸æˆå¼€å§‹');
    }
    
    update(deltaTime) {
        if (!this.isRunning) return;
        
        // æ¸¸æˆé€»è¾‘æ›´æ–°
        this.updatePlayer();
        this.updateEnemies();
        this.checkCollisions();
    }
    
    updatePlayer() {
        // ç©å®¶æ›´æ–°é€»è¾‘
    }
    
    updateEnemies() {
        // æ•Œäººæ›´æ–°é€»è¾‘
    }
    
    checkCollisions() {
        // ç¢°æ’æ£€æµ‹
    }
    
    addScore(points) {
        this.score += points;
    }
    
    loseLife() {
        this.lives--;
        if (this.lives <= 0) {
            this.gameOver();
        }
    }
    
    gameOver() {
        this.isRunning = false;
        console.log('æ¸¸æˆç»“æŸ');
    }
}

// å¯¼å‡ºæ¸¸æˆé€»è¾‘
window.GameLogic = GameLogic;`;
            }
            
            generateRuntimeEngine() {
                return `// è¿è¡Œæ—¶å¼•æ“
// è´Ÿè´£æ¸¸æˆçš„æ ¸å¿ƒè¿è¡Œ

class GameRuntime {
    constructor() {
        this.app = null;
        this.gameLogic = null;
        this.lastTime = 0;
        this.isRunning = false;
    }
    
    async init(width, height) {
        // åˆå§‹åŒ–PIXIåº”ç”¨
        this.app = new PIXI.Application({
            width: width,
            height: height,
            backgroundColor: 0x000000,
            antialias: true
        });
        
        // åˆå§‹åŒ–æ¸¸æˆé€»è¾‘
        this.gameLogic = new GameLogic();
        
        // å¼€å§‹æ¸¸æˆå¾ªç¯
        this.startGameLoop();
    }
    
    startGameLoop() {
        this.isRunning = true;
        this.gameLoop();
    }
    
    gameLoop(currentTime = 0) {
        if (!this.isRunning) return;
        
        const deltaTime = currentTime - this.lastTime;
        this.lastTime = currentTime;
        
        // æ›´æ–°æ¸¸æˆé€»è¾‘
        if (this.gameLogic) {
            this.gameLogic.update(deltaTime);
        }
        
        // ç»§ç»­æ¸¸æˆå¾ªç¯
        requestAnimationFrame((time) => this.gameLoop(time));
    }
    
    stop() {
        this.isRunning = false;
    }
    
    getApp() {
        return this.app;
    }
}

// å¯¼å‡ºè¿è¡Œæ—¶å¼•æ“
window.GameRuntime = GameRuntime;`;
            }
            
            async loadIndexHtml() {
                try {
                    const response = await fetch('/build/index.html');
                    return await response.text();
                } catch (error) {
                    return '// æ— æ³•åŠ è½½ index.html æ–‡ä»¶\n' + error.message;
                }
            }
            
            generateConfig() {
                return `// æ¸¸æˆé…ç½®æ–‡ä»¶
// ç»Ÿä¸€ç®¡ç†æ¸¸æˆè®¾ç½®

window.GameConfig = {
    // æ¸¸æˆåŸºæœ¬ä¿¡æ¯
    gameInfo: {
        name: 'Game Editor Demo',
        version: '1.0.0',
        author: 'Game Editor Team'
    },
    
    // æ˜¾ç¤ºé…ç½®
    display: {
        designWidth: 750,
        designHeight: 1334,
        backgroundColor: '#000000'
    },
    
    // æ€§èƒ½é…ç½®
    performance: {
        targetFPS: 60,
        enableVSync: true
    },
    
    // éŸ³é¢‘é…ç½®
    audio: {
        masterVolume: 0.7,
        musicVolume: 0.5,
        sfxVolume: 0.8
    },
    
    // è°ƒè¯•é…ç½®
    debug: {
        showFPS: false,
        enableConsole: true,
        logLevel: 'info'
    }
};`;
            }
        }
        
        // åˆå§‹åŒ–ä»£ç ç”Ÿæˆå™¨
        const codeGenerator = new CodeGenerator();
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        document.querySelectorAll('.code-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.getAttribute('data-tab');
                
                // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                
                // æ¿€æ´»å½“å‰æ ‡ç­¾
                tab.classList.add('active');
                
                // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾é¡µå†…å®¹
                const targetElement = document.getElementById(`${targetTab}-tab`);
                if (targetElement) {
                    targetElement.classList.add('active');
                    updateCodeDisplay(targetTab);
                }
            });
        });
        
        // æ›´æ–°ä»£ç æ˜¾ç¤º
        function updateCodeDisplay(tabType) {
            let code = '';
            let elementId = '';
            
            switch (tabType) {
                case 'game-logic':
                    code = codeGenerator.generateGameLogic();
                    elementId = 'gameLogicDisplay';
                    break;
                case 'runtime':
                    code = codeGenerator.generateRuntimeEngine();
                    elementId = 'runtimeDisplay';
                    break;
                case 'index-html':
                    codeGenerator.loadIndexHtml().then(html => {
                        const element = document.getElementById('indexHtmlDisplay');
                        if (element) {
                            element.textContent = html;
                        }
                    });
                    return;
                case 'config':
                    code = codeGenerator.generateConfig();
                    elementId = 'configDisplay';
                    break;
                default:
                    return;
            }
            
            const codeDisplay = document.getElementById(elementId);
            if (codeDisplay) {
                codeDisplay.textContent = code;
            }
        }
        
        // åˆ·æ–°ä»£ç 
        function refreshCode() {
            const activeTab = document.querySelector('.code-tab.active');
            if (activeTab) {
                const targetTab = activeTab.getAttribute('data-tab');
                updateCodeDisplay(targetTab);
            }
        }
        
        // å¤åˆ¶ä»£ç 
        function copyCode() {
            const activePane = document.querySelector('.tab-pane.active');
            const codeDisplay = activePane.querySelector('.code-display');
            if (codeDisplay) {
                navigator.clipboard.writeText(codeDisplay.textContent).then(() => {
                    alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                });
            }
        }
        
        // ä¸‹è½½ä»£ç 
        function downloadCode() {
            const activePane = document.querySelector('.tab-pane.active');
            const codeDisplay = activePane.querySelector('.code-display');
            if (codeDisplay) {
                const blob = new Blob([codeDisplay.textContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'game-code.txt';
                a.click();
                URL.revokeObjectURL(url);
            }
        }
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        updateCodeDisplay('game-logic');
    </script>
</body>
</html> 